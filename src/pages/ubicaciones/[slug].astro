---
import { DEFAULT_LANG } from '../../lib/i18n';
import { getLocationsSlugs } from '../../lib/sanity';

export async function getStaticPaths() {
  const slugs = await getLocationsSlugs();
  return slugs
    .filter(entry => entry?.slug?.current)
    .map(entry => ({
      params: { slug: entry.slug.current },
    }));
}

const { slug } = Astro.params;
const search = Astro.url.search;
const destination = search 
  ? `/${DEFAULT_LANG}/ubicaciones/${slug}${search}` 
  : `/${DEFAULT_LANG}/ubicaciones/${slug}`;
return Astro.redirect(destination, 307);
---
